use Dicosts 5.0

blast with Workbench, to discover pr-5 gene family, using cucumis melo genes as query



1- go to "Analyze", click on Interactive Plylogenetics Moedule"
2- select the gene family and paste "HOM05D000102"
3- In the "Species selection" tab, check glycine max.
4- In "MSA algorithm", select MAFFT and click "creat MSA\tree". this will generate the and the phylogenetic tree from the
5- On the files tab, under "Results", select View Multi-Sequence Alignment. you have the option to see the edited (always few preserved) and unedited.

## GmPR-1 gene identification

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data loading and preprocessing

- Proteome: **PLAZA Dicots 5.0**
- Protein domain annotation: **Biomart**

```{r}
data_dir <- here::here("data/")
proteome <- Biostrings::readAAStringSet(paste0(data_dir, "proteome.fasta.gz"))
names(proteome) <- sapply(strsplit(names(proteome), " | "), tail, 1)

```

# Load gene annotation
plaza_annotation_interpro <- read.delim2(paste0(data_dir,"interpro.gma.csv.gz"), skip = 8, col.names = c("Gene_ID", "Species", "Motif_ID", "Description", "Start", "Stop", "Score", "Comment"), sep = "\t")
plaza_annotation <- as.data.frame(plaza_annotation)
head(plaza_annotation)
names(plaza_annotation)

## GmPR-5 gene identification

**Uniprot search**: name:"pathogenesis-related protein 5" AND reviewed:yes AND organism:"Arabidopsis thaliana (Mouse-ear cress) [3702]"
*Results*: 	P28493 (At1g75040)


```{r}
library(rBLAST)
source(here::here("code", "functions.R"))
# AA StringSet from Uniprot sequences
seq_pr5 <- uniprot2stringset("P28493")
```

```{r}
# Get Vigna mungo PR-5 to use as outgroup (top BLASTp hit)
data_dir <- here::here("data/")
outgroup_pr5 <- Biostrings::readAAStringSet(paste0(data_dir, "sequencia-fasta-outgroup-vm.fa"))
names(outgroup_pr5) <- "VMungo1215G1788"
```

```{r}
# Export one sequence to be used as outgroup for the tree
Biostrings::writeXStringSet(outgroup_pr5, 
                            filepath = here::here("products", "result_files",                                                "outgroup_PR5.fa"))
```


```{r}
# Blast search
blast_pr5 <- blast_search(query = seq_pr5, db=proteome, BLAST_args = "-evalue 1e-10")
head(blast_pr5)
dim(blast_pr5)
```



```{r}

# Get IDs of putative PR-1 genes in soybean
pr5_putative_s1 <- unique(blast_pr5[,2])
length(pr5_putative_s1)
```

```{r}
pr5_putative_s2 <- find_domains(ids=pr5_putative_s1, 
                                annotation=plaza_annotation_interpro,
                                pfam="PF00188", smart="SM000198")
nrow(pr1_putative_s2)
```


Finally, we need to export data to the appropriate directory.

```{r}
seqs_pr5 <- proteome[pr5_putative_s2$Gene.Name]
writeXStringSet(seqs_pr5, 
                filepath = here::here("products", "result_files", "pr5.fa"))
```


```{bash}
sed 's/*//g' ../products/result_files/pr1.fa > ../products/result_files/pr1_nostopcodon.fa
```


